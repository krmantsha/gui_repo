<!DOCTYPE html>

<html >
  <head>
    <meta charset="utf-8" />
    <title>Inventory &#8212; SeisComP Release documentation</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/seiscomp.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <script type="text/javascript" src="../../_static/seiscomp.js"></script>
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Configuration" href="configuration.html" />
    <link rel="prev" title="RecordStream" href="recordstream.html" /> 
  </head>
  <body>
    <div class="header">
      <div class="container">
        <div class="brand">
          <img class="logo" src="../../_static/brands/seiscomp/text/white.svg"/>
           <!-- span class="title">SeisComP Release</span -->
          <span class="version">4.6.0</span>
        </div>
      </div>
    </div>
    <div class="nav">
      <div class="container">
        <div class="content"><a class="pull-right" id="sidebar-toggle">TOC</a>
          
    <div class="related" role="navigation" aria-label="related navigation">
      <ul>
        <li class="right">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">
            index
          </a>
        </li>
        <li class="right">
          <a href="configuration.html" title="Configuration"
             accesskey="N">
            next
          </a>
        </li>
        <li class="right">
          <a href="recordstream.html" title="RecordStream"
             accesskey="P">
            previous
          </a>
        </li>
        <li class="nav-item nav-item-0">
          <a href="../../index.html">Home</a>
        </li>
        <li class="nav-item nav-item-1">
          <a href="../concepts.html" accesskey="U">Concepts</a>
        </li> 
      </ul>
    </div>
        </div>
      </div>
    </div>
    <div class="container">
      <div class="fitted content" id="anchors-container">
        <div class="body" role="main">
          
  <div class="section" id="inventory">
<span id="concepts-inventory"></span><h1>Inventory<a class="headerlink" href="#inventory" title="Permalink to this headline">¶</a></h1>
<div class="section" id="scope">
<h2>Scope<a class="headerlink" href="#scope" title="Permalink to this headline">¶</a></h2>
<p>This chapter describes the concept of inventories.</p>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>In SeisComP the term <a class="reference internal" href="../glossary.html#term-inventory"><span class="xref std std-term">inventory</span></a> refers to the meta data of data recording stations.
Many SeisComP applications require inventory information to operate correctly.
The inventory will be read from the <a class="reference internal" href="database.html#concepts-database"><span class="std std-ref">database</span></a>
by default. To insert or update the inventory in the database, this information
needs to be created or downloaded and converted. The following sections will
describe the process of populating the database and how applications get access
to it. All SeisComP applications work the the internal inventory format also
known as SCML.</p>
<p>The inventory shall contain all meta data describing the full recording system and the
pre-processing of the raw data stream provided to the data processing modules
using the <a class="reference internal" href="recordstream.html#concepts-recordstream"><span class="std std-ref">RecordStream</span></a>. Inventories should be always complete w.r.t the
processed data streams, correct and up-to-date. Beside network, station, location
and stream information they must include the full sensor and datalogger responses.</p>
<p>Older version used key files to configure available networks and stations.
Because the support of response meta-data was very limited, tools were build to add
this functionality. Since the release of Seattle the concept of key files for station meta-data has
been completely removed from the system. Now SeisComP only handles station meta-data in its
own XML format called <strong>inventory ML</strong>.
The task of supporting old key files, dataless SEED and other formats has been
out-sourced to external applications. The inventory synchronization is a
<a class="reference internal" href="#config-fig-inventory-sync"><span class="std std-ref">two-stage process</span></a>:</p>
<ol class="arabic simple">
<li><p>Convert external formats into inventory ML</p></li>
<li><p>Synchronize inventory pool with the database: merged all inventory files and
synchronize with the database using <strong class="program">seiscomp update-config</strong>.</p></li>
</ol>
<div class="figure align-center" id="id1">
<span id="config-fig-inventory-sync"></span><img alt="../../_images/inventory-sync.png" src="../../_images/inventory-sync.png" />
<p class="caption"><span class="caption-text">Inventory synchronization as a two-stage process</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<p>All station meta-data are stored in <code class="file docutils literal notranslate"><span class="pre">etc/inventory</span></code>
and can be organized as needed. Either one file per network, a file containing the complete inventory
or one file for all instruments and one file per station. The update script</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span>scinv sync
</pre></div>
</div>
<p>loads the existing inventory from the database and merges each file in <code class="file docutils literal notranslate"><span class="pre">etc/inventory</span></code>.
Finally it removes all unreferenced
objects and sends all updates to the database.</p>
<p>The SeisComP <a class="reference internal" href="modules.html#concepts-modules"><span class="std std-ref">configuration</span></a> does not deal with station meta-data anymore.
It only configures parameters for modules and module-station associations.
The management of the inventory can and should be handled by external tools, e.g. <a class="reference external" href="https://smp.gempa.de/">SMP</a> <a class="footnote-reference brackets" href="#id2" id="id3">1</a>.</p>
<p>The SeisComP documentation describes the data model including the
<span class="xref std std-ref">inventory</span>.</p>
</div>
<div class="section" id="inventory-format">
<h2>Inventory format<a class="headerlink" href="#inventory-format" title="Permalink to this headline">¶</a></h2>
<p>A typical inventory file in SCML looks like this:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="nt">&lt;seiscomp</span> <span class="na">xmlns=</span><span class="s">&quot;http://geofon.gfz-potsdam.de/ns/seiscomp-schema/0.11&quot;</span> <span class="na">version=</span><span class="s">&quot;0.11&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;Inventory&gt;</span>
    <span class="nt">&lt;sensor&gt;</span>...
    <span class="nt">&lt;datalogger&gt;</span>...
    <span class="nt">&lt;network&gt;</span>...
  <span class="nt">&lt;/Inventory&gt;</span>
<span class="nt">&lt;/seiscomp&gt;</span>
</pre></div>
</div>
<p>The version attribute of the <code class="docutils literal notranslate"><span class="pre">seiscomp</span></code> tag represents the schema version of
the SeisComP data model which is consistent with the database schema version
and the version of all other representations.</p>
<p>Inventories must be provided to SeisComP in XML files in SCML format. A convenient
way to generate clean and correct inventory files in SCML format is <a class="reference external" href="https://smp.gempa.de/">SMP</a> <a class="footnote-reference brackets" href="#id2" id="id4">1</a>.
Tools are provided to convert from other formats:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../../apps/fdsnxml2inv.html#fdsnxml2inv"><span class="std std-ref">fdsnxml2inv</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/dlsv2inv.html#dlsv2inv"><span class="std std-ref">dlsv2inv</span></a></p></li>
<li><p><span class="xref std std-ref">arclink2inv</span></p></li>
</ul>
</div>
<div class="section" id="adding-updating-inventory">
<h2>Adding/updating inventory<a class="headerlink" href="#adding-updating-inventory" title="Permalink to this headline">¶</a></h2>
<p>To add inventory information to the SeisComP database one either has to write directly
to the database with custom script (not recommended) or place SC ML files
under <cite>etc/inventory</cite>. The service to import all data in that directory can
be called with</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ seiscomp update-config inventory
</pre></div>
</div>
<p>This command runs <a class="reference internal" href="../../apps/scinv.html#scinv"><span class="std std-ref">scinv</span></a> finally. <a class="reference internal" href="../../apps/scinv.html#scinv"><span class="std std-ref">scinv</span></a> merges all XML files and
synchronizes the merged local inventory tree with the database. That is a
rather complex process and for more information it is recommended to study
the source code of <a class="reference internal" href="../../apps/scinv.html#scinv"><span class="std std-ref">scinv</span></a>. The bottom line is that inventory data is created
from SC ML files.</p>
<p>Because nobody will ever create such XML files by hand, tools are necessary.
A quite popular tools is the online station management portal <a class="reference external" href="https://smp.gempa.de/">SMP</a> <a class="footnote-reference brackets" href="#id2" id="id5">1</a>.
This tool will output SeisComP XML directly.</p>
<p>Another source is the FDSN station webservice. If the SeisComP implementation
is being run then the SeisComP XML format can be requested directly as an
extension. Otherwise FDSN StationXML will be provided. That need to be converted
with either <a class="reference internal" href="../../apps/fdsnxml2inv.html#fdsnxml2inv"><span class="std std-ref">fdsnxml2inv</span></a> or <a class="reference internal" href="../../apps/import_inv.html#import-inv"><span class="std std-ref">import_inv</span></a>. The latter is a more versatile
application that also supports several import formats.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ import_inv fdsnxml download-1234.xml
</pre></div>
</div>
<p>This will automatically place the output SC ML file in <code class="file docutils literal notranslate"><span class="pre">etc/inventory</span></code>.
<code class="docutils literal notranslate"><span class="pre">seiscomp</span> <span class="pre">update-config</span> <span class="pre">inventory</span></code> must be called afterwards to synchronize
the changes with the database. If <code class="docutils literal notranslate"><span class="pre">scconfig</span></code> is being used then either the
<code class="docutils literal notranslate"><span class="pre">Sync</span></code> button of the <cite>Inventory</cite> panel or the <code class="docutils literal notranslate"><span class="pre">Update</span> <span class="pre">configuration</span></code> button of
the <code class="docutils literal notranslate"><span class="pre">System</span></code> panel must pressed.</p>
<p><strong>Summary</strong></p>
<p>In order to populate the database with inventory information, the following
steps have to be performed:</p>
<ul class="simple">
<li><p>Convert existing station meta data formats to SC ML</p></li>
<li><p>Place all SC ML files at <code class="file docutils literal notranslate"><span class="pre">etc/inventory</span></code></p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">seiscomp</span> <span class="pre">update-config</span></code> or <code class="docutils literal notranslate"><span class="pre">seiscomp</span> <span class="pre">update-config</span> <span class="pre">inventory</span></code></p></li>
</ul>
</div>
<div class="section" id="reading-inventory">
<h2>Reading inventory<a class="headerlink" href="#reading-inventory" title="Permalink to this headline">¶</a></h2>
<p>Application usually connect to the database and read the necessary inventory
information. An application can decide whether it requires full response
information (sensor and datalogger response functions) or just channel
information (without instrument descriptions). The latter performs faster and
some applications do not full instrument information.</p>
<p>An application does not require special configuration to read
inventory information. A database connection is enough and it comes usually
along with the handshake message of the messaging server.</p>
<p>There are cases when an application should be run without a database connection
but requires inventory information, particularly in combination with the
<code class="docutils literal notranslate"><span class="pre">--ep</span></code> command line argument. To direct an application to an inventory XML file
(again in SC ML format), <code class="docutils literal notranslate"><span class="pre">--inventory-db</span></code> must be used:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$ myapp --inventory-db inv.xml
</pre></div>
</div>
<p>That will completely bypass the database (even if used for event information)
for reading inventory information. The file <em>inv.xml</em> can be created from the database
using <a class="reference internal" href="../../apps/scxmldump.html#scxmldump"><span class="std std-ref">scxmldump</span></a>.</p>
</div>
<div class="section" id="related-tools">
<h2>Related tools<a class="headerlink" href="#related-tools" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><span class="xref std std-ref">arclink2inv</span></p></li>
<li><p><a class="reference internal" href="../../apps/dlsv2inv.html#dlsv2inv"><span class="std std-ref">dlsv2inv</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/fdsnxml2inv.html#fdsnxml2inv"><span class="std std-ref">fdsnxml2inv</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/import_inv.html#import-inv"><span class="std std-ref">import_inv</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/invextr.html#invextr"><span class="std std-ref">invextr</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/inv2dlsv.html#inv2dlsv"><span class="std std-ref">inv2dlsv</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/sccnv.html#sccnv"><span class="std std-ref">sccnv</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/scinv.html#scinv"><span class="std std-ref">scinv</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/scxmldump.html#scxmldump"><span class="std std-ref">scxmldump</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/tab2inv.html#tab2inv"><span class="std std-ref">tab2inv</span></a></p></li>
<li><p><a class="reference internal" href="../../apps/tabinvmodifier.html#tabinvmodifier"><span class="std std-ref">tabinvmodifier</span></a></p></li>
</ul>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets">1</span><span class="fn-backref">(<a href="#id3">1</a>,<a href="#id4">2</a>,<a href="#id5">3</a>)</span></dt>
<dd><p><a class="reference external" href="https://smp.gempa.de/">https://smp.gempa.de/</a></p>
</dd>
</dl>
</div>
</div>


          <div id="anchors-bottom"></div>
        </div>
        
      <div class="sidebar" role="navigation" aria-label="main navigation">
        <div id="anchors-top"></div>
        <div id="anchors" class="content">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
  <h3><a href="../../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Inventory</a><ul>
<li><a class="reference internal" href="#scope">Scope</a></li>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#inventory-format">Inventory format</a></li>
<li><a class="reference internal" href="#adding-updating-inventory">Adding/updating inventory</a></li>
<li><a class="reference internal" href="#reading-inventory">Reading inventory</a></li>
<li><a class="reference internal" href="#related-tools">Related tools</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="recordstream.html"
                        title="previous chapter">RecordStream</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="configuration.html"
                        title="next chapter">Configuration</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/base/concepts/inventory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
        </div>
      </div>
      </div>
    </div>
    <div class="footer">
      <div class="container">
        <div class="horizontal layout content">
        <a class="fade-in" href="https://www.gempa.de" target="_blank">
          <img class="brand" src="../../_static/brands/gempa.svg"/>
        </a>
        <div class="stretched align-center fitted content">
          <div>
		  Version <b>4.6.0</b> Release
          </div>
            <div class="copyright">
              Copyright &copy; gempa GmbH, GFZ Potsdam.
            </div>
        </div>
        <a class="fade-in" href="https://www.gfz-potsdam.de" target="_blank">
          <img class="brand" src="../../_static/brands/gfz.svg"/>
        </a>
        </div>
      </div>
    </div>
  </body>
</html>